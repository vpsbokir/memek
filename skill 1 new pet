for i = 1, 1 do

wait(2)

local character = game.Players.LocalPlayer.Character or game.Players.LocalPlayer.CharacterAdded:Wait()
local part1 = workspace.Map:WaitForChild("Paths"):WaitForChild("1"):WaitForChild("Start")
local part2 = workspace.Map:WaitForChild("Paths"):WaitForChild("1"):WaitForChild("1")
local part3 = workspace.Map:WaitForChild("Paths"):WaitForChild("1"):WaitForChild("2")
local part4 = workspace.Map:WaitForChild("Paths"):WaitForChild("1"):WaitForChild("2")

-- Set CFrame karakter ke posisi part1 dan part2
character.HumanoidRootPart.CFrame = part1.CFrame
character.HumanoidRootPart.CFrame = part2.CFrame

-- Menghitung midpoint antara part1 dan part2, serta antara part2 dan part3
local midpoint = (part1.Position + part2.Position) / 2
local midpoint2 = (part2.Position + part4.Position) / 2
local finalMidpoint = (midpoint + midpoint2) / 2

-- Geser sedikit ke kanan dengan menambah nilai pada sumbu X (horizontal)
local offset = Vector3.new(-2, 0, 0)  -- Menambahkan 2 stud ke arah kanan (sumbu X)
local finalPositionWithOffset = finalMidpoint + offset

-- Set CFrame karakter ke posisi final dengan offset ke kanan
character.HumanoidRootPart.CFrame = CFrame.new(finalPositionWithOffset)

task.wait(2)

local args = {
    [1] = "Reset"
}

game:GetService("ReplicatedStorage").Remotes.Misc.StopSettings:FireServer(unpack(args))


for i = 1, 68 do

game:GetService("ReplicatedStorage").Remotes.Misc.StopSettings:FireServer()
end

local humanoidRootPartCFrame = character.HumanoidRootPart.CFrame

local args = {
    [1] = "Tarnished Fredbear",
    [2] = humanoidRootPartCFrame
}
game:GetService("ReplicatedStorage").Remotes.Towers.SummonTower:FireServer(unpack(args))




local character = game.Players.LocalPlayer.Character or game.Players.LocalPlayer.CharacterAdded:Wait()
local part1 = workspace.Map:WaitForChild("Paths"):WaitForChild("1"):WaitForChild("Start")
local part2 = workspace.Map:WaitForChild("Paths"):WaitForChild("1"):WaitForChild("1")
local part3 = workspace.Map:WaitForChild("Paths"):WaitForChild("1"):WaitForChild("2")
local part4 = workspace.Map:WaitForChild("Paths"):WaitForChild("1"):WaitForChild("2")

-- Set CFrame karakter ke posisi part1 dan part2
character.HumanoidRootPart.CFrame = part1.CFrame
character.HumanoidRootPart.CFrame = part2.CFrame

-- Menghitung midpoint antara part1 dan part2, serta antara part2 dan part3
local midpoint = (part1.Position + part2.Position) / 2
local midpoint2 = (part2.Position + part4.Position) / 2
local finalMidpoint = (midpoint + midpoint2) / 2

-- Geser sedikit ke kanan dengan menambah nilai pada sumbu X (horizontal)
local offset = Vector3.new(-2, 0, -5)  -- Menambahkan 2 stud ke arah kanan (sumbu X)
local finalPositionWithOffset = finalMidpoint + offset

-- Set CFrame karakter ke posisi final dengan offset ke kanan
character.HumanoidRootPart.CFrame = CFrame.new(finalPositionWithOffset)


task.wait(2)

local args = {
    [1] = "Reset"
}

game:GetService("ReplicatedStorage").Remotes.Misc.StopSettings:FireServer(unpack(args))


for i = 1, 68 do

game:GetService("ReplicatedStorage").Remotes.Misc.StopSettings:FireServer()
end

local humanoidRootPartCFrame = character.HumanoidRootPart.CFrame

local args = {
    [1] = "Tarnished Fredbear",
    [2] = humanoidRootPartCFrame
}

game:GetService("ReplicatedStorage").Remotes.Towers.SummonTower:FireServer(unpack(args))


local character = game.Players.LocalPlayer.Character or game.Players.LocalPlayer.CharacterAdded:Wait()
local part1 = workspace.Map:WaitForChild("Paths"):WaitForChild("1"):WaitForChild("Start")
local part2 = workspace.Map:WaitForChild("Paths"):WaitForChild("1"):WaitForChild("1")
local part3 = workspace.Map:WaitForChild("Paths"):WaitForChild("1"):WaitForChild("2")
local part4 = workspace.Map:WaitForChild("Paths"):WaitForChild("1"):WaitForChild("2")

-- Set CFrame karakter ke posisi part1 dan part2
character.HumanoidRootPart.CFrame = part1.CFrame
character.HumanoidRootPart.CFrame = part2.CFrame

-- Menghitung midpoint antara part1 dan part2, serta antara part2 dan part3
local midpoint = (part1.Position + part2.Position) / 2
local midpoint2 = (part2.Position + part4.Position) / 2
local finalMidpoint = (midpoint + midpoint2) / 2

-- Geser sedikit ke kanan dengan menambah nilai pada sumbu X (horizontal)
local offset = Vector3.new(-2, 0, -10)  -- Menambahkan 2 stud ke arah kanan (sumbu X)
local finalPositionWithOffset = finalMidpoint + offset

-- Set CFrame karakter ke posisi final dengan offset ke kanan
character.HumanoidRootPart.CFrame = CFrame.new(finalPositionWithOffset)

task.wait(2)

local args = {
    [1] = "Reset"
}

game:GetService("ReplicatedStorage").Remotes.Misc.StopSettings:FireServer(unpack(args))


for i = 1, 68 do

game:GetService("ReplicatedStorage").Remotes.Misc.StopSettings:FireServer()
end

local humanoidRootPartCFrame = character.HumanoidRootPart.CFrame

local args = {
    [1] = "Tarnished Fredbear",
    [2] = humanoidRootPartCFrame
}

game:GetService("ReplicatedStorage").Remotes.Towers.SummonTower:FireServer(unpack(args))
local character = game.Players.LocalPlayer.Character or game.Players.LocalPlayer.CharacterAdded:Wait()
local part1 = workspace.Map:WaitForChild("Paths"):WaitForChild("1"):WaitForChild("Start")
local part2 = workspace.Map:WaitForChild("Paths"):WaitForChild("1"):WaitForChild("1")
local part3 = workspace.Map:WaitForChild("Paths"):WaitForChild("1"):WaitForChild("2")
local part4 = workspace.Map:WaitForChild("Paths"):WaitForChild("1"):WaitForChild("2")

-- Set CFrame karakter ke posisi part1 dan part2
character.HumanoidRootPart.CFrame = part1.CFrame
character.HumanoidRootPart.CFrame = part2.CFrame

-- Menghitung midpoint antara part1 dan part2, serta antara part2 dan part3
local midpoint = (part1.Position + part2.Position) / 2
local midpoint2 = (part2.Position + part4.Position) / 2
local finalMidpoint = (midpoint + midpoint2) / 2

-- Geser sedikit ke kiri dengan menambah nilai pada sumbu X (horizontal)
local offset = Vector3.new(-14, 0, -5)  -- Menambahkan 2 stud ke arah kiri (sumbu X)
local finalPositionWithOffset = finalMidpoint + offset

-- Set CFrame karakter ke posisi final dengan offset ke kiri
character.HumanoidRootPart.CFrame = CFrame.new(finalPositionWithOffset)

task.wait(1.5)

local args = {
    [1] = "Reset"
}

game:GetService("ReplicatedStorage").Remotes.Misc.StopSettings:FireServer(unpack(args))


for i = 1, 68 do

game:GetService("ReplicatedStorage").Remotes.Misc.StopSettings:FireServer()
end

local humanoidRootPartCFrame = character.HumanoidRootPart.CFrame

local args = {
    [1] = "Windup Bonnie",
    [2] = humanoidRootPartCFrame
}

game:GetService("ReplicatedStorage").Remotes.Towers.SummonTower:FireServer(unpack(args))

  local args = {
        [1] = "HellMode"
    }
    game:GetService("ReplicatedStorage").Remotes.Main.Modifiers:FireServer(unpack(args))

local unitNames = {"Tarnished Fredbear", "Windup Bonnie"}  -- Daftar nama unit yang akan di-upgrade

for i = 1, 16 do
    for _, unitName in ipairs(unitNames) do
        local allUpgradableUnits = {}
        
        -- Mencari unit berdasarkan nama
        for _, unit in pairs(workspace.Towers:GetChildren()) do
            if unit.Name == unitName then
                local primaryPart = unit:FindFirstChildWhichIsA("BasePart")
                if primaryPart then
                    table.insert(allUpgradableUnits, unit)
                end
            end
        end
        
        -- Jika ada unit yang bisa di-upgrade, lakukan upgrade
        if #allUpgradableUnits > 0 then
            for _, unit in ipairs(allUpgradableUnits) do
                local upgradeArgs = {
                    [1] = unit
                }
                local success, err = pcall(function()
                    game:GetService("ReplicatedStorage").Remotes.Towers.Upgrade:FireServer(unpack(upgradeArgs))
                end)
                if not success then
                    warn("Upgrade failed for unit: " .. unit.Name .. " with error: " .. err)
                end
            end
        end
    end
    wait(1)  -- Tunggu 2 detik sebelum iterasi berikutnya
end

end



for i = 1, 3 do
wait(1)

local character = game.Players.LocalPlayer.Character or game.Players.LocalPlayer.CharacterAdded:Wait()
local part1 = workspace.Map:WaitForChild("Paths"):WaitForChild("1"):WaitForChild("Start")
local part2 = workspace.Map:WaitForChild("Paths"):WaitForChild("1"):WaitForChild("1")
local part3 = workspace.Map:WaitForChild("Paths"):WaitForChild("1"):WaitForChild("2")
local part4 = workspace.Map:WaitForChild("Paths"):WaitForChild("1"):WaitForChild("2")

-- Set CFrame karakter ke posisi part1 dan part2
character.HumanoidRootPart.CFrame = part1.CFrame
character.HumanoidRootPart.CFrame = part2.CFrame

-- Menghitung midpoint antara part1 dan part2, serta antara part2 dan part3
local midpoint = (part1.Position + part2.Position) / 2
local midpoint2 = (part2.Position + part4.Position) / 2
local finalMidpoint = (midpoint + midpoint2) / 2

-- Geser sedikit ke kiri dengan menambah nilai pada sumbu X (horizontal)
local offset = Vector3.new(7, 0, -5)  -- Menambahkan 2 stud ke arah kiri (sumbu X)
local finalPositionWithOffset = finalMidpoint + offset

-- Set CFrame karakter ke posisi final dengan offset ke kiri
character.HumanoidRootPart.CFrame = CFrame.new(finalPositionWithOffset)

task.wait(1.5)

local args = {
    [1] = "Reset"
}

game:GetService("ReplicatedStorage").Remotes.Misc.StopSettings:FireServer(unpack(args))


for i = 1, 68 do

game:GetService("ReplicatedStorage").Remotes.Misc.StopSettings:FireServer()
end

local humanoidRootPartCFrame = character.HumanoidRootPart.CFrame

local args = {
    [1] = "ITS ME",
    [2] = humanoidRootPartCFrame
}

game:GetService("ReplicatedStorage").Remotes.Towers.SummonTower:FireServer(unpack(args))
end



for i = 1, 2 do

local character = game.Players.LocalPlayer.Character or game.Players.LocalPlayer.CharacterAdded:Wait()
local part1 = workspace.Map:WaitForChild("Paths"):WaitForChild("1"):WaitForChild("Start")
local part2 = workspace.Map:WaitForChild("Paths"):WaitForChild("1"):WaitForChild("1")
local part3 = workspace.Map:WaitForChild("Paths"):WaitForChild("1"):WaitForChild("2")
local part4 = workspace.Map:WaitForChild("Paths"):WaitForChild("1"):WaitForChild("2")

-- Set CFrame karakter ke posisi part1 dan part2
character.HumanoidRootPart.CFrame = part1.CFrame
character.HumanoidRootPart.CFrame = part2.CFrame

-- Menghitung midpoint antara part1 dan part2, serta antara part2 dan part3
local midpoint = (part1.Position + part2.Position) / 2
local midpoint2 = (part2.Position + part4.Position) / 2
local finalMidpoint = (midpoint + midpoint2) / 2

-- Geser sedikit ke kiri dengan menambah nilai pada sumbu X (horizontal)
local offset = Vector3.new(5, 0, 5)  -- Menambahkan 2 stud ke arah kiri (sumbu X)
local finalPositionWithOffset = finalMidpoint + offset

-- Set CFrame karakter ke posisi final dengan offset ke kiri
character.HumanoidRootPart.CFrame = CFrame.new(finalPositionWithOffset)

task.wait(1.5)

local args = {
    [1] = "Reset"
}

game:GetService("ReplicatedStorage").Remotes.Misc.StopSettings:FireServer(unpack(args))


for i = 1, 68 do

game:GetService("ReplicatedStorage").Remotes.Misc.StopSettings:FireServer()
end

local humanoidRootPartCFrame = character.HumanoidRootPart.CFrame

local args = {
    [1] = "Shadow of Afton",
    [2] = humanoidRootPartCFrame
}

game:GetService("ReplicatedStorage").Remotes.Towers.SummonTower:FireServer(unpack(args))

local character = game.Players.LocalPlayer.Character or game.Players.LocalPlayer.CharacterAdded:Wait()
local part1 = workspace.Map:WaitForChild("Paths"):WaitForChild("1"):WaitForChild("Start")
local part2 = workspace.Map:WaitForChild("Paths"):WaitForChild("1"):WaitForChild("1")
local part3 = workspace.Map:WaitForChild("Paths"):WaitForChild("1"):WaitForChild("2")
local part4 = workspace.Map:WaitForChild("Paths"):WaitForChild("1"):WaitForChild("2")

-- Set CFrame karakter ke posisi part1 dan part2
character.HumanoidRootPart.CFrame = part1.CFrame
character.HumanoidRootPart.CFrame = part2.CFrame

-- Menghitung midpoint antara part1 dan part2, serta antara part2 dan part3
local midpoint = (part1.Position + part2.Position) / 2
local midpoint2 = (part2.Position + part4.Position) / 2
local finalMidpoint = (midpoint + midpoint2) / 2

-- Geser sedikit ke kiri dengan menambah nilai pada sumbu X (horizontal)
local offset = Vector3.new(5, 0, -15)  -- Menambahkan 2 stud ke arah kiri (sumbu X)
local finalPositionWithOffset = finalMidpoint + offset

-- Set CFrame karakter ke posisi final dengan offset ke kiri
character.HumanoidRootPart.CFrame = CFrame.new(finalPositionWithOffset)

task.wait(1.5)

local args = {
    [1] = "Reset"
}

game:GetService("ReplicatedStorage").Remotes.Misc.StopSettings:FireServer(unpack(args))


for i = 1, 68 do

game:GetService("ReplicatedStorage").Remotes.Misc.StopSettings:FireServer()
end

local humanoidRootPartCFrame = character.HumanoidRootPart.CFrame

local args = {
    [1] = "Shadow of Afton",
    [2] = humanoidRootPartCFrame
}

game:GetService("ReplicatedStorage").Remotes.Towers.SummonTower:FireServer(unpack(args))


local unitNames = {"Shadow of Afton", "ITS ME"}

for i = 1, 16 do
    for _, unitName in ipairs(unitNames) do
        local allUpgradableUnits = {}
        
        -- Mencari unit berdasarkan nama
        for _, unit in pairs(workspace.Towers:GetChildren()) do
            if unit.Name == unitName then
                local primaryPart = unit:FindFirstChildWhichIsA("BasePart")
                if primaryPart then
                    table.insert(allUpgradableUnits, unit)
                end
            end
        end
        
        -- Jika ada unit yang bisa di-upgrade, lakukan upgrade
        if #allUpgradableUnits > 0 then
            for _, unit in ipairs(allUpgradableUnits) do
                local upgradeArgs = {
                    [1] = unit
                }
                local success, err = pcall(function()
                    game:GetService("ReplicatedStorage").Remotes.Towers.Upgrade:FireServer(unpack(upgradeArgs))
                end)
                if not success then
                    warn("Upgrade failed for unit: " .. unit.Name .. " with error: " .. err)
                end
            end
        end
    end
    wait(1)  -- Tunggu 2 detik sebelum iterasi berikutnya
end

end
